## IP 주소 

### 2.4.1 ARP
- 컴퓨터와 컨퓨터 통신은 IP 주소 기반인가?
이게 아니고, IP 주소에서 ARP를 통해 MAC 주소를 기반으로 통신함

ARP란,
IP 주소로부터 MAC 주소를 구하는 IP와 MAC 사이의 다리 역할을 하는 프로토콜

RARP란,
실제 주소인 MAC 주소를 가상 주소인 IP 주소로 변환

ARP를 찾는 과정
- ARP Request 브로드캐스트를 보냄
- IP 주소에 해당하는 MAC 주소를 찾음
- ARP Reply 유니캐스트를 통해 MAC 주소를 변환하여 IP주소에 맞는 MAC 주소를 찾음
  * 브로드캐스트란, 송신 호스트가 전송한 데이터가 네트워크에 연결된 모든 호스트에 전송되는 방식
  * 유니캐스트란, 고유 주소로 식별된 하나의 네트워크 목적지에 1:1로 데이터를 전송하는 방식

### 2.4.2 홉바이홉 통신
 홉바이홉 통신이란,
 - IP 주소를 통해 통신하는 과정을 뜻함
 - 통신망에서 각 패킷이 여러 개의 라우터를 건너가는 모습을 홉(건너뜀)에 비유하여 표현한 것
 - 수많은 서브 네트워크 안에 있는 라우터의 라우팅 테이블 IP를 기반으로 패킷을 전달하고 전달해나가며 라우팅을 수행하여 최종 목적지까지 전달
  ![image](https://github.com/GDSC-SWU/2023-CS-Study/assets/97941141/f1d0ea6f-8eda-4891-945e-8668e8c60ac3)

라우팅 테이블이란,
라우팅은 IP 주소를 찾아가는 과정을 뜻함
여기서 라우팅 테이블은 그 과정(송신지에서 수신지까지 도달)에 사용되며, 라우터에 들어가 있는 *목적지정보*들과 *목적지로 가기 위한 방법*이 들어 있는 리스트를 뜻함
-> 즉, 게이트웨이와 모든 목적지에 대해 해당 목적지에 도달하기 위해 거쳐야 할 다음 라우터의 정보를 갖고 있음
  * 게이트웨이란, 
  * 서로 다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문 역할을 하는 컴퓨터나 소프트웨어
  * 사용자는 수많은 게이트웨이를 거쳐 인터넷에 접속
  * 서로 다른 네트워크상의 통신 프로토콜을 변환해주는 역할
  * 라우팅 테이블을 통해 볼 수 있음(netstat -r)

### 2.4.3 IP 주소 체계
- IPv4
  - 32비트를 8비트 단위로 점을 찍어 표기
  - 현재 가장 많이 쓰이는 주소 체계


- IPv6
  - 64비트를 16비트 단위로 점을 찍어 표기]
  - 이제 많이 쓰려고 하는 주소 체계

* 클래스 기반 할당 방식
![image](https://github.com/GDSC-SWU/2023-CS-Study/assets/97941141/0b4d134e-05fb-4c45-830d-6cc6fcac9c70)
- 클래스 A,B,C는 일대일 통신으로, D는 멀티캐스트 통신, E는 앞으로 사용할 예비용으로 쓰는 방식
- 맨 왼쪽의 비트는 구분 비트로, A는 0으로, B는 10으로, C는 110으로 설정되어 있으며 이를 통해 클래스 간의 IP를 나눔(따라서 갖고 있는 주소의 범위는 A > B > C)

![image](https://github.com/GDSC-SWU/2023-CS-Study/assets/97941141/de43a55a-0d9c-4005-a308-92a3b859becd)
- 앞 부분은 네트워크 주소, 중간 부분은 호스트 주소, 뒷 부분은 브로드캐스트용 주소로 사용됨(실질적으로 사용할 수 있는 주소는 호스트 주소) 
-> 이 방식은 사용하는 주소보다 버리는 주소가 많은 단점이 있음
-> 따라서 DHCP, IPv6, NAT 출현
* DHCP
  * IP 주소 및 기타 통신 매개변수를 자동으로 할당하기 위한 네트워크 관리 프로토콜
  * 네트워크 장치의 IP 주소를 수동으로 설정할 필요 없이 인터넷에 접속할 때마다 *자동으로 IP 주소를 할당 가능* 
* NAT
  ![image](https://github.com/GDSC-SWU/2023-CS-Study/assets/97941141/ba2b9e4c-283b-411c-af71-dae5510bd891)
  * 패킷이 라우팅 장치를 통해 전송되는 동안 패킷의 IP 주소 정보를 수정하여 IP 주소를 다른 주소로 매핑하는 방법
  * IPv4 주소 체계만으로는 많은 주소들을 모두 감당하지 못하는 단점을 해결하기 위해 해당 방법으로 공인 IP와 사설 IP로 나눠서 많은 주소 처리
  * 이를 가능하게 하는 소프트웨어는 ICS, RRAS, Netfilter 등이 있음   
  * 주로 여러 대의 호스트가 하나의 공인 IP 주소를 사용하여 인터넷에 접속하기 위해 사용
  * 내부 네트워크에서 사용하는 IP 주소와 외부에 드러나는 IP 주소를 다르게 유지할 수 있기 때문에 내부 네트워크에 대한 보안 가능
  * 여러 명이 동시에 인터넷을 접속하게 되므로 실제로 접속하는 호스트 숫자에 따라서 접속 속도가 느려질 수 있음

### 2.4.4 IP 주소를 이용한 위치 정보
- IP 주소는 인터넷에서 사용하는 네트워크 주소이기 때문에 이를 통해 동 또는 구까지 위치 추적이 가능함

### HTTP
애플리케이션 계층으로서 웹 서비스 통신에 사용됨

## HTTP/1.0
- 한 연결당 하나의 요청을 처리하도록 설계됨
- 서버로부터 파일을 가져올 때마다 TCP의 3-웨이 핸드세이크를 계속해서 열어야 하기 때문에 *RTT 증가*를 불러오게 됨
 * RTT란, 패킷이 목적지에 도달하고 나서 다시 출발지로 돌아오기까지 걸리는 시간으로, 패킷 왕복 시간
 * RTT 증가의 문제점은, 서버에 부담이 많이 가고 사용자 응답 시간이 길어짐
 * RTT 증가의 해결책은, 이미지 스플리팅, 코드 압축, 이미지 Base64 인코딩 사용
  * 이미지 스플리팅이란, 이미지가 합쳐있는 하나의 이미지를 다운로드하고, 이를 기반으로 position을 이용하여 이미지를 표기
  * 코드 압축이란, 개행 문자, 빈칸을 없애서 코드의 크기를 최소화하는 것  
  * 이미지 Base64 인코딩이란, 이미지 파일을 64진법으로 이루어진 문자열로 인코딩하는 방법
   * 장점: 서버와의 연결을 열고 이미지에 대해 서버에 HTTP 요청을 할 필요가 없음
   * 단점: 37% 정도 크기가 더 커짐
   * 인코딩이란, 정보의 형태나 형식을 표준화, 보안, 처리 속도 향상, 저장 공간 절약 등을 위해 다른 형태나 형식으로 변환하는 처리 방식

## HTTP/1.1
- 한 번 TCP 초기화를 한 이후에 keep-alive라는 옵션으로 **여러 개**의 파일을 송수신할 수 있음
- HTTP/1.0에도 keep-alive가 있었으나, 표준화가 되어 있지 않았음
- 한 번 TCP 3-웨이 핸드셰이크가 발생하면 그다음부터 발생하지 않음
- 문서에 포함된 다수의 리소스를 처리하려면 요청할 리소스 개수에 비례해서 대기 시간이 길어짐
 * HOL Blocking이란, 네트워크에서 같은 큐에 있는 패킷이 그 첫 번째 패킷에 의해 지연될 때 발생하는 성능 저하 현상
- 무거운 헤더 구조로, 많은 메타데이터가 들어 이씨고 압축되지 않아 무거움

## HTTP/2
- SPDY 프로토콜에서 파생된 HTTP/1.x보다 지연 시간을 줄이고 응답 시간을 더 빠르게 할 수 있음
- 멀티플렉싱, 헤더 압축, 서버 푸시, 요청의 우선순위 처리를 지원
 * 멀티플렉싱이란, 여러 개의 스트림을 사용하여 송수신하는 것
  * 특정 스트림의 패킷이 손실되었다고 하더라도 해당 스트림에만 영향을 미치고 나머지 스트림은 멀쩡하게 동작 가능
   * 스트림이란, 시간이 지남에 따라 사용할 수 있게 되는 일련의 데이터 요소를 가리키는 데이터 흐름
 -> 병렬로 처리 가능, 스트림 내의 데이터도 헤더와 데이터로 쪼개져 있으며, 애플리케이션에서 받아온 메시지를 독립된 프레임으로 조각내어 서로 송수신한 이후 다시 조립하며 데이터를 주고 받음
 -> 단일 연결을 사용하여 병렬로 여러 요청을 받고 응답을 줄 수 있음(HOL Blocking 해결)
 * 헤더 압축이란, 크기가 큰 헤더를 압축하는 것으로 허프만 코딩 압축 알고리즘을 사용하는 HPACK 압축 형식을 가짐
  * 허프만 코딩이란, 
   * 문자열을 문자 단위로 쪼개 빈도수를 세어 빈도가 높은 정보를 적은 비트 수를 사용하여 표현
   * 빈도가 낮은 정보는 비트 수를 많이 사용하여 표현해서 전체 데이터의 표현에 필요한 비트양을 줄이는 원리
 * 서버 푸시란,
  * 클라이언트 요청 없이 서버가 바로 리소스를 푸시할 수 있는 것(그 전에는 클라이언트의 요청이 있어야 리소스 다운로드 가능)  
 
## HTTPS
- HTTP/2는 HTTPs 위에서 동작함
- 애플리케이션 계층과 전송 계층 사잉에 신뢰 계층인 SSL/TLS 꼐층을 넣은 신뢰할 수 있는 HTTP 요청
- 통신을 암호화하는 역할

- SSL/TLS
- SSL1.0 - TLS1.3까지 버전이 올라가며 명칭이 변경되어 왔으나, 보통 합쳐서 부름
- 보안을 제공하는 프로토콜로, 클라이언트와 서버가 통신할 때 이를 통해 제 3자가 메시지를 도청하거나 변조하지 못하도록 함
- 보안 세션을 기반으로 암호화하며 보안 세션이 만들어질 때 인증 메커니즘, 키 교환 암호화 알고리즘, 해싱 알고리즘 사용
- 보안 세션이란, 보안이 시작되고 끝나는 동안 유지되는 세션으로, SSL/TLS는 핸드셰이크를 통해 보안 세션을 생성하고 이를 기반으로 상태 정보를 공유함
- 세션이란, 운영체제가 어떠한 사용자로부터 자신의 자산 이용을 허락하는 일정한 기간을 뜻함

TLS의 핸드셰이크
![image](https://github.com/GDSC-SWU/2023-CS-Study/assets/97941141/80d7333f-a5ed-4e22-83e6-75f27dd79f33)
클라이언트와 서버와 키를 공유하고 이를 기반으로 인증 확인 작업이 일어나는 단 한 번의 1-RTT가 생긴 후 데이터를 송수신함
1. 클라이언트에서 사이퍼 슈트를 서버에 전달
2. 서버는 받은 사이퍼 슈트의 암호화 알고리즘 리스트를 제공할 수 있는지 확인
3. 제공 가능하다면, 서버에서 클라이언트로 인증서를 보내는 인증 메커니즘이 시작
4. 해싱 알고리즘 등으로 암호화된 데이터의 송수신이 시작됨

* 사이퍼 슈트란, 프로토콜, AEAD 사이퍼 모드, 해싱 알고리즘이 나열된 규약 / 5개 존재
* AEAD란, 데이터 암호화 알고리즘
* 인증 메커니즘이란, CA에서 발급한 인증서를 기반으로 이루어짐 
 CA에서 발급한 인증서는 서비스 정보, 공개키, 지문, 디지털 서명 등으로 이루어져 있음
 1. 안전한 연결을 시작하는 데 있어 필요한 '공개키'를 클라이언트에게 제공
 2. 사용자가 접속한 서버가 신뢰할 수 있는 서버임을 보장함

* CA 발급 과정
 1. 자신의 사이트 정보와 공개키를 CA에 제출
 2. CA는 공개키를 해시한 값인 지문을 사용하는 CA의 비밀키 등을 기반으로 CA인증서를 발급

* 공개키란, 공개되어 있는 키, 개인키란, 비밀키라고도 하며 개인이 소유하고 있는 키이자 반드시 자신만이 소유해야 하는 키

* 암호화 알고리즘이란, 대수곡선 기반의 ECDHE 또는 모듈식 기반인 DHE를 사용함
* 둘 다 디피-헬만 방식을 근간으로 만들어진 것
* 디피-헬만 키 교환 알고리즘이란, 암호키를 교환하는 하나의 방법
![image](https://github.com/GDSC-SWU/2023-CS-Study/assets/97941141/0ef88856-35c3-4aad-b402-8e791e249fd5)
1. 처음에 공개 값을 공유함
2. 각자의 비밀 값과 혼합한 후 혼합 값을 공유
3. 각자의 비밀 값과 혼합
4. 공통의 암호키 PSK 생성
- 악의적인 공격자가 개인키 또는 공개키를 가지고도 PSK가 없다면 아무것도 할 수 없는 것

* 해싱 알고리즘이란, 데이터를 추정하기 힘든 더 작고, 섞여 있는 조각으로 만드는 알고리즘
* SSL/TLS는 해싱 알고리즘으로 SHA-256 알고리즘과 SHA-384 알고리즘을 씀
* SHA-256 알고리즘이란, 해시 함수의 결과값이 256비트인 알고리즘
* 이는 해싱을 해야 할 메시지에 1을 추가하는 등 전처리를 하고 전처리된 메시지를 기반으로 해시를 반환함

* 해시란, 다양한 길이를 가진 데이터를 고정된 길이를 가진 데이터로 매핑한 값
* 해싱이란, 임의의 데이터를 해시로 바꿔주는 일이며 해시 함수가 이를 담당
* 해시 함수란, 임의의 데이터를 입력으로 받아 일정한 길이의 데이터로 바꿔주는 함수

- SEO에도 도움이 되는 HTTPS
- SEO란, 검색 엔진 최적화를 뜻하며 사용자들이 검색엔진으로 웹 사이트를 검색했을 때 그 결과를 페이지 상단에 노출시켜 많은 사람이 볼 수 있도록 최적화하는 방법
- 캐노니컬 설정
- link에 캐노니컬을 설정해야 함

- 메타 설정
- html 파일의 가장 윗부분인 메타를 잘 설정해야 함

- 페이지 속도 개선
- 구글의 PageSpeedInsight로 가서 자신의 서비스에 대한 리포팅을 주기적으로 받으며 관리해야 함

- 사이트맵 관리
- 사이트맵 제너레이터를 사용하거나 직접 코드를 만들어 구축해도 괜찮음

HTTPS 구축 방법
- CA에서 구매한 인증키를 기반으로 서비스 구축
- 서버 앞단의 HTTPS를 제공하는 로드밸런서를 두어 구축
- 서버 앞단에 HTTPS를 제공하는 CDN을 두어 구축

## HTTP/3
- TCP 위에서 돌아가는 버전 2와 달리, QUIC라는 계층 위에서 돌아감
- TCP가 아닌 UDP 기반으로 돌아감
- 멀티플렉싱을 갖고 있으며 초기 연결 설정 시 지연 시간 감소라는 장점이 있음
- TCP를 사용하지 않기 때문에 통신을 시작할 때 번거로운 3-웨이 핸드셰이크 과정을 거치지 않아도 괜찮아 첫 연결 설정에 1-RTT만 소요됨
- 순방향 오류 수정 메커니즘이 적용되어 전송한 패킷이 손실되었다면 수신 측에서 에러를 검출하고 수정하는 방식 사용으로 낮은 패킷 손실률을 가짐

